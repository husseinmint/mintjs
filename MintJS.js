!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).MintJS=t()}(this,(function(){"use strict";const e=/s\d{2}(-w\d{3}-h\d{3})?-c/;function t(e){for(const t of e)if("alternate"===t.rel)return t.href}function a(e){return e.replace(/<[^>]*>?/g,"")}function n(e){if(!e)return!1;const t=e.querySelector("[data-bjs=template]");if(!t)return!1;t.removeAttribute("data-bjs");const a=t.outerHTML;return t.remove(),a.replace(/data-src/g,"src")}function r(e,t){return e.replace(/\{\{(.*?)\}\}/g,((e,a)=>t[a]))}function l({dataset:e={}}){const t={};return Object.keys(e).forEach((a=>{var n;t[a]="true"===(n=e[a])||"false"!==n&&(Number(n).toString()===n?Number(n):"null"===n||""===n?null:n)})),t}function s(e){const t=document.createElement("script");t.src=e,document.body.appendChild(t).parentNode.removeChild(t)}const i={small:"s80-c",medium:"s300",large:"s500",max:"s800"},o={small:"default",medium:"mqdefault",large:"hqdefault",max:"maxresdefault"},c={homepage:window.location.origin+"/",category:null,locale:"ar-EG",snippet:100,format:{month:"long",day:"2-digit",year:"numeric"},image:"",imageSize:"s300",avatarImage:"https://www.gravatar.com/avatar/?d=mm",avatarSize:"s80",authorName:"Unknown",authorUrl:"",labels:{}};function u(e){return null!=e&&"string"==typeof e&&e.includes("img.youtube.com")}function m(t,a){return u(t)?t.replace("default",o[a]||a):t.replace(e,i[a]||a)}function g(e,t){return null!=e&&e.length?(e=e?.map((e=>`<a class='${t.prefixClass+e.term}' href='${t.origin}search/label/${e.term}'>${t.before+e.term+t.after}</a>`))?.join(""),`<div class='${t.containerClass}'>${e}</div>`):[]}function d(e,n){const[r]=e.author,l=e.content?e.content.$t:e.summary.$t,s={...c,...n},i=e.id.$t.split(".post-"),o=i[1],d=i[0].split(":blog-")[1],p=e.media$thumbnail?e.media$thumbnail.url:function(e){const t=document.createElement("div");t.innerHTML=e;const a=t.querySelector("img");return a?a.src:""}(l)||s.image,f=r.gd$image.src.includes("g/blank.gif")||r.gd$image.src.includes("g/b16-rounded.gif")?s.avatarImage:r.gd$image.src,b=s.homepage,h=s.labels.length||10,$=(null!==e.category&&e.category)?.filter((e=>!e.term.includes(s.labels.without||"undefined_terms")))?.filter((e=>!(s.labels.remove||[]).includes(e.term))).slice(0,h),y=e.category?.filter((e=>e.term.includes(s.labels.terms||""))).slice(0,h),x=e.category?.filter((e=>(s.labels.filter||[]).includes(e.term))).slice(0,h),v={origin:b,prefixClass:s.labels.prefixClass||"label-",containerClass:s.labels.containerClass||"labels",before:s.labels.before||"",after:s.labels.after||""};return{blog_id:d,post_id:o,author_name:"Unknown"!==r.name.$t?r.name.$t:s.authorName,author_url:r.uri?r.uri.$t:s.authorUrl,author_image:f.replace(/s\B\d{2,4}/,s.avatarSize),author_email:r.email?r.email.$t:"#noEmail",img:m(p,u(p)?s.ytThumbnail:s.imageSize),img_max:m(p,"max"),img_large:m(p,"large"),img_medium:m(p,"medium"),img_small:m(p,"small"),time:(T=e.published.$t,w={locale:s.locale,format:s.format},new Date(T).toLocaleDateString(w.locale,w.format)),snippet:(C=a(l),P=s.snippet,C.length>P?`${C.substring(0,P)}...`:C),labels:null==$?[]:$?.map((e=>e.term)),labels_links:g($,v),labels_filter:g(x,v),labels_terms:g(y,v),content:a(l),url:t(e.link),published:new Date(e.published.$t).getTime(),title:e.title.$t,update:new Date(e.updated.$t).getTime(),category:s.category,thr:e.thr$total?e.thr$total.$t:"0"};var C,P,T,w}function p(){const e=new URLSearchParams(window.location.search);let t=e.get("page");var a;return(null===t||(a=t,Number(a).toString()!==a)||Number(t)<1)&&(t="1"),{page:Number(t),results:e.get("max-results"),label:e.get("label"),view:e.get("view")}}const f={},b=(e,t,a)=>{const{homepage:n,category:l}=t,i=n,o=t.category.replace(/[^A-Z0-9]/gi,"")+a;f[o]=a=>{let n="";a.feed.entry?a.feed.entry.forEach((e=>{const a=d(e,t);n+=r(t.template,a)})):n+=t.empty,e.innerHTML=n,e.classList.add("is-loaded")},s(`${i}feeds/posts/default?alt=json-in-script&callback=MintJS.sections.${o}&max-results=${t.maxResults}&category=${l}`)},h={observer:!0,maxResults:6,rootMargin:"200px",template:'<div class="bjs-article">\n  <img src="{{img}}"/>\n  <a href="{{url}}">{{title}}</a>\n</div>',empty:"<p>لم يتم العثور علي مقالات</p>"},$={},y={maxResults:6,template:'<div class="bjs-comments">\n  <img src="{{author_image}}"/>\n  <a href="{{url}}">{{author_name}}</a>\n  <p>{{snippet}}</p>\n</div>',empty:"<p>Sin comentarios</p>"};let x={id:"",length:7,maxResults:8,tags:[],random:!0,template:'<div class="bjs-article">\n  <img src="{{img}}"/>\n  <a href="{{url}}">{{title}}</a>\n</div>'};const v=document.querySelector("[data-bjs=related]");function C({number:e,label:t,perPage:a}){let n=`/search?page=${e}`;const r={...p()};return t&&(n+=`&label=${t}`),r.view&&(n+=`&view=${r.view}`),n+=`&max-results=${r.results??a}`,n}function P({active:e,url:t,title:a,className:n=""}){const r=document.createElement("li"),l=document.createElement("a");return l.href=t,l.innerHTML=a,l.className=n,e&&r.classList.add("is-active"),r.appendChild(l),r}function T({className:e}){const t=document.createElement("li"),a=document.createElement("span");return a.textContent="...",a.className=e,t.appendChild(a),t}function w({homepage:e,firstPage:t,perPage:a,label:n,active:r,className:l}){return P({url:t?e:C({number:"1",label:n,perPage:a}),title:"1",active:r,className:l})}let M={firstPage:!1,perPage:7,length:5,label:null,prevText:"السابق",nextText:"التالي",lastPageText:null,ytThumbnail:"mqdefault",template:'<div><img src="{{img}}"/><a href="{{url}}">{{title}}</a></div>',empty:"<p>No se ha encontrado entradas</p>",numberClass:"bjs-number",nextPageClass:"bjs-next-page",prevPageClass:"bjs-prev-page",firstPageClass:"bjs-first-page",lastPageClass:"bjs-last-page",dotsPageClass:"bjs-dots",firstPageVisible:!0,lastPageVisible:!0,infinite:!1,withButton:!1,buttonClass:"bjs-button-show-more",buttonText:"تحميل المزيد",buttonTextLoading:"جاري التحميل",rootMargin:"100px"};function N({homepage:e,label:t,perPage:a,page:n}){s(`${e}feeds/posts/default${t?`/-/${t}`:""}?alt=json-in-script&callback=MintJS.entry&max-results=${a}&start-index=${(n-1)*a+1}`)}const j=document.querySelector("[data-bjs=entry]"),S=document.querySelector("[data-bjs=pagination]");let E,L=1,_=!1;function k(e){j.innerHTML+=e}var H={sections:f,comments:$,related:function(e){if(!e.feed.entry)return;let t="",a=e.feed.entry.filter((e=>function(e){return e.id.$t.split(".post-")[1]}(e)!==x.id));x.random&&(a=function(e){const t=null==e?0:e.length;if(!t)return[];let a=-1;const n=t-1,r=function(e,t){let a=-1;const n=e.length;for(t||(t=new Array(n));++a<n;)t[a]=e[a];return t}(e);for(;++a<t;){const e=a+Math.floor(Math.random()*(n-a+1)),t=r[e];r[e]=r[a],r[a]=t}return r}(a));const n=a.length<=x.length?a.length:x.length;Array.from({length:n}).forEach(((e,n)=>{t+=r(x.template,d(a[n],x))})),v.innerHTML=t},entry:function(e){if(!e.feed.entry)return j.innerHTML="",k(M.empty),void(M.infinite&&S.remove());if(M.infinite){const{button:t,container:a}=E;_=!1,function({data:e,options:t,page:a,container:n}){t.firstPage||1!==a||(n.innerHTML=""),e.forEach((e=>{t.firstPage&&1===a||(n.innerHTML+=r(t.template,d(e,t)))}))}({button:t,container:a,page:L,data:e.feed.entry,options:M}),M.withButton&&(t.textContent=M.buttonText);const n=Number(e.feed.openSearch$totalResults.$t),l=Math.ceil(n/(M.results??M.perPage));return void(L>=l&&S.remove())}const t=function({options:e,data:t,container:a}){let n="";return t.feed.entry.forEach((t=>{n+=r(e.template,d(t,e))})),function({container:e,page:t,results:a,perPage:n,length:r,total:l,label:s,prevText:i,nextText:o,lastPageText:c,firstPage:u,homepage:m,numberClass:g,nextPageClass:d,prevPageClass:p,lastPageClass:f,firstPageClass:b,dotsPageClass:h,firstPageVisible:$,lastPageVisible:y}){const x=document.createDocumentFragment(),v=Math.ceil(l/(a??n)),M=function(e,t,a){const n=[];e>a&&(e=a);let r=1,l=a||1;a>=t&&(l=Math.min(Math.max(e+Math.ceil(t/2)-1,t),a),r=l-t+1);for(let e=r;e<=l;e++)n.push(e);return n}(t,r,v);if(t-1>0){const e=P({url:u&&t-1==1?m:C({number:t-1,label:s,perPage:n}),title:i,className:p});x.appendChild(e)}if($&&!M.includes(1)){const e=w({firstPage:u,homepage:m,label:s,className:b,perPage:n}),t=T({className:h});x.appendChild(e),x.appendChild(t)}if(M.forEach((e=>{let a=null;a=1===e?w({firstPage:u,homepage:m,label:s,active:e===t,className:g,perPage:n}):P({url:C({number:e,label:s,perPage:n}),title:e,active:e===t,className:g}),x.appendChild(a)})),y&&!M.includes(v)){const e=P({url:C({number:v,label:s,perPage:n}),title:c||v,className:f}),t=T({className:h});x.appendChild(t),x.appendChild(e)}if(t+1<=v){const e=P({url:C({number:t+1,label:s,perPage:n}),title:o,className:d});x.appendChild(e)}e.innerHTML="",e.appendChild(x)}({...e,total:Number(t.feed.openSearch$totalResults.$t),container:a}),n}({options:M,data:e,container:S});j&&(j.innerHTML="",k(t))},initComments:function(e={}){Array.from(document.querySelectorAll("[data-bjs=comments]")).forEach(((t,a)=>{const i={...y,...e,...l(t)},o=n(t);o&&(i.template=o),((e,t,a)=>{const n="comments"+a;$[n]=a=>{let n="";a.feed.entry?a.feed.entry.forEach((e=>{const a=d(e,t);n+=r(t.template,a)})):n+=t.empty,e.innerHTML=n},s(`${t.homepage}feeds/comments/default?alt=json-in-script&callback=MintJS.comments.${n}&max-results=${t.maxResults}`)})(t,i,a)}))},initRelated:function(e={}){if(!v)return;x={...x,...e,...l(v)};const t=n(v);t&&(x.template=t);const a=("string"==typeof x.tags?JSON.parse(x.tags):x.tags).map((e=>`label:"${e}"`)).join("|");s(`${x.homepage}feeds/posts/default?alt=json-in-script&callback=MintJS.related&max-results=${x.maxResults}&q=${a}`)},initEntry:function(e={}){M={...M,...p(),...e,...l(j||!1),...l(S||!1)};const t=n(j);t&&(M.template=t);const{firstPage:a,homepage:r,page:i,label:o,withButton:c,buttonClass:u,buttonText:m,rootMargin:g}=M,d=M.results??M.perPage,f=`${r}feeds/posts/default${o?`/-/${o}`:""}?alt=json-in-script&callback=MintJS.entry&max-results=${d}`;if(M.infinite){if(!j||!S)return;s(`${a?f.replace(/max-results=(.[0-9]*)/,"max-results=1"):f}&start-index=1`),E=function({container:e,pagination:t,withButton:a=!1,buttonClass:n,buttonText:r,onClick:l=(()=>{}),onVisible:s=(()=>{}),rootMargin:i="100px"}){let o=null;if(a)o=document.createElement("button"),o.className=n,o.textContent=r,o.addEventListener("click",(()=>{l({button:o,container:e})})),t.innerHTML="",t.appendChild(o);else{new IntersectionObserver((e=>{e.forEach((e=>{e.isIntersecting&&s()}))}),{rootMargin:i}).observe(t)}return{container:e,button:o}}({buttonClass:u,buttonText:m,rootMargin:g,withButton:c,container:j,pagination:S,onClick({button:e}){_||(e.textContent=M.buttonTextLoading,_=!0,L++,N({label:o,perPage:d,homepage:r,page:L}))},onVisible(){L++,N({label:o,perPage:d,homepage:r,page:L})}})}else s(`${f}&start-index=${(i-1)*d+1}`)},initSection:function(e={}){Array.from(document.querySelectorAll("[data-bjs=section]")).forEach(((t,a)=>{const r={...h,...e,...l(t)},s=n(t);if(s&&(r.template=s),!0===r.observer){const e=new IntersectionObserver((n=>{n.forEach((n=>{n.isIntersecting&&(b(t,r,a),e.unobserve(n.target))}))}),{rootMargin:r.rootMargin});e.observe(t)}else b(t,r,a)}))}};return H}));
